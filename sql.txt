CREATE TABLE Requests (
    requestID BIGINT AUTO_INCREMENT PRIMARY KEY,
    address varchar(100) NOT NULL,
    number_of_rooms INT NOT NULL,
    date DATETIME NOT NULL,
    budget DECIMAL(10,2) NOT NULL,
    cleaning_type ENUM('basic', 'deep-clean', 'move-out') NOT NULL,
    notes TEXT,
    client_id INT NOT NULL, 
    FOREIGN KEY (client_id) REFERENCES Users(client_id)
);

CREATE TABLE Quote ( 
    quoteID BIGINT, 
    requestID BIGINT NOT NULL,
    response_number INT,
    status ENUM('awaiting client', 'awaiting admin') NOT NULL, 
    price NUMERIC(10,2) NOT NULL, date DATETIME NOT NULL, 
    notes TEXT, PRIMARY KEY (quoteID, response_number), 
    FOREIGN KEY (requestID) REFERENCES Requests(requestID) 
);

CREATE TABLE Orders (
    orderID BIGINT AUTO_INCREMENT PRIMARY KEY,
    quoteID BIGINT,
    response_number INT,
    address VARCHAR(100) NOT NULL,
    number_of_rooms INT NOT NULL,
    date DATETIME NOT NULL,
    price NUMERIC(8,2) NOT NULL,
    notes TEXT,
    FOREIGN KEY (quoteID, response_number, client_id) REFERENCES Quote(quoteID, response_number, client_id)
    );

CREATE TABLE Bill (
    billID BIGINT AUTO_INCREMENT,
    bill_number INT,
    orderID BIGINT,
    price NUMERIC(8,2) NOT NULL,
    status ENUM('awaiting client', 'awaiting admin') NOT NULL,
    date_issued datetime DEFAULT current_timestamp() NOT NULL,
    notes TEXT,
    PRIMARY KEY (billID, bill_number),
    FOREIGN KEY (orderID) REFERENCES Orders(orderID)
);

CREATE TABLE Payment (
    paymentID BIGINT AUTO_INCREMENT PRIMARY KEY,
    billID BIGINT,
    bill_number INT,
    price NUMERIC(8,2) NOT NULL,
    card_number char(16) NOT NULL,
    status ENUM('awaiting payment', 'paid'),
    date_paid datetime DEFAULT current_timestamp() NOT NULL,
    FOREIGN KEY (billID, bill_number) REFERENCES Bill(billID, bill_number)
);

CREATE TABLE Users (
    client_id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    email VARCHAR(50),
    password VARCHAR(100) NOT NULL,
    first_name VARCHAR(50) NOT NULL,
    last_name VARCHAR(50) NOT NULL,
    phone_number VARCHAR(10) NOT NULL, 
    street VARCHAR(100) NOT NULL,
    city VARCHAR(100) NOT NULL, 
    state VARCHAR(50) NOT NULL, 
    zipcode VARCHAR(10) NOT NULL, 
    card_number VARCHAR(20) NOT NULL, 
    ex_date VARCHAR(10) NOT NULL, 
    cvv VARCHAR(4) NOT NULL,
    account_type ENUM('client', 'admin') NOT NULL
);