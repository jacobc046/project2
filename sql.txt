CREATE TABLE `Users` (
  `client_id` int(11) NOT NULL AUTO_INCREMENT,
  `email` varchar(50) NOT NULL,
  `password` varchar(100) NOT NULL,
  `first_name` varchar(50) NOT NULL,
  `last_name` varchar(50) NOT NULL,
  `phone_number` varchar(10) NOT NULL,
  `street` varchar(100) NOT NULL,
  `city` varchar(100) NOT NULL,
  `state` varchar(50) NOT NULL,
  `zipcode` varchar(10) NOT NULL,
  `card_number` varchar(20) NOT NULL,
  `ex_date` varchar(10) NOT NULL,
  `cvv` varchar(4) NOT NULL,
  `account_type` enum('client','admin') NOT NULL,
  PRIMARY KEY (`client_id`)
)

CREATE TABLE `requests` (
  `requestID` bigint(20) NOT NULL AUTO_INCREMENT,
  `address` varchar(100) NOT NULL,
  `number_of_rooms` int(11) NOT NULL,
  `date` datetime NOT NULL,
  `budget` decimal(10,2) NOT NULL,
  `notes` text DEFAULT NULL,
  `cleaning_type` enum('basic','deep-clean','move-out') NOT NULL,
  `image1` longblob DEFAULT NULL,
  `image2` longblob DEFAULT NULL,
  `image3` longblob DEFAULT NULL,
  `image4` longblob DEFAULT NULL,
  `image5` longblob DEFAULT NULL,
  `client_ID` int(11) NOT NULL,
  `status` enum('new','quoted','rejected') NOT NULL,
  PRIMARY KEY (`requestID`),
  KEY `client_ID` (`client_ID`),
  CONSTRAINT `requests_ibfk_1` FOREIGN KEY (`client_ID`) REFERENCES `Users` (`client_id`)
)

CREATE TABLE `Quote` (
  `quoteID` bigint(20) NOT NULL AUTO_INCREMENT,
  `requestID` bigint(20) DEFAULT NULL,
  `response_number` int(11) NOT NULL,
  `status` enum('awaiting client','awaiting admin','accepted','cancelled') NOT NULL,
  `price` decimal(10,2) NOT NULL,
  `date` datetime NOT NULL,
  `notes` text DEFAULT NULL,
  `client_id` int(11) DEFAULT NULL,
  PRIMARY KEY (`quoteID`,`response_number`),
  KEY `requestID` (`requestID`),
  KEY `client_id` (`client_id`),
  CONSTRAINT `quote_ibfk_1` FOREIGN KEY (`requestID`) REFERENCES `Requests` (`requestID`),
  CONSTRAINT `quote_ibfk_2` FOREIGN KEY (`client_id`) REFERENCES `requests` (`client_ID`)
)

CREATE TABLE `Orders` (
  `orderID` bigint(20) NOT NULL AUTO_INCREMENT,
  `quoteID` bigint(20) DEFAULT NULL,
  `response_number` int(11) DEFAULT NULL,
  `address` varchar(100) NOT NULL,
  `number_of_rooms` int(11) NOT NULL,
  `date` datetime NOT NULL,
  `price` decimal(8,2) NOT NULL,
  `notes` text DEFAULT NULL,
  `client_id` int(11) DEFAULT NULL,
  PRIMARY KEY (`orderID`),
  KEY `client_id` (`client_id`),
  KEY `orders_ibfk_1` (`quoteID`,`response_number`),
  CONSTRAINT `orders_ibfk_2` FOREIGN KEY (`client_id`) REFERENCES `Quote` (`client_id`)
)

CREATE TABLE `Bill` (
  `billID` bigint(20) NOT NULL AUTO_INCREMENT,
  `bill_number` int(11) NOT NULL,
  `orderID` bigint(20) DEFAULT NULL,
  `price` decimal(8,2) NOT NULL,
  `status` enum('awaiting client','awaiting admin') NOT NULL,
  `notes` text DEFAULT NULL,
  `date_issued` datetime NOT NULL DEFAULT current_timestamp(),
  PRIMARY KEY (`billID`,`bill_number`),
  KEY `bill_ibfk_1` (`orderID`),
  CONSTRAINT `bill_ibfk_1` FOREIGN KEY (`orderID`) REFERENCES `Orders` (`orderID`)
)

CREATE TABLE `Payment` (
  `paymentID` bigint(20) NOT NULL AUTO_INCREMENT,
  `billID` bigint(20) DEFAULT NULL,
  `bill_number` int(11) DEFAULT NULL,
  `price` decimal(8,2) NOT NULL,
  `card_number` char(20) DEFAULT NULL,
  `status` enum('awaiting payment','paid') DEFAULT NULL,
  `date_paid` datetime DEFAULT current_timestamp(),
  `CVV` char(4) DEFAULT NULL,
  `ex_date` char(10) DEFAULT NULL,
  PRIMARY KEY (`paymentID`),
  KEY `key1` (`billID`,`bill_number`),
  CONSTRAINT `key1` FOREIGN KEY (`billID`, `bill_number`) REFERENCES `Bill` (`billID`, `bill_number`)
)